{% extends "base.html" %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card text-center">
                <div class="card-body p-5">
                    <h1 class="display-4 fw-bold text-primary mb-4">
                        <i class="fas fa-film me-3"></i>Movie Collection Scanner
                    </h1>
                    <p class="lead text-muted mb-5">
                        Easily scan and catalog your physical movie collection. 
                        Scan barcodes or search by title to build your digital library.
                    </p>
                    
                    <div class="row g-4">
                        <div class="col-md-6">
                            <div class="card h-100 border-0 bg-light">
                                <div class="card-body text-center p-4">
                                    <i class="fas fa-qrcode fa-3x text-primary mb-3"></i>
                                    <h5 class="card-title">Scan Movies</h5>
                                    <p class="card-text">Use your camera to scan barcodes and automatically add movies to your collection.</p>
                                    <a href="/scan" class="btn btn-primary">
                                        <i class="fas fa-camera me-2"></i>Start Scanning
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card h-100 border-0 bg-light">
                                <div class="card-body text-center p-4">
                                    <i class="fas fa-list fa-3x text-success mb-3"></i>
                                    <h5 class="card-title">View Collection</h5>
                                    <p class="card-text">Browse your entire movie collection with detailed information and cover art.</p>
                                    <a href="/collection" class="btn btn-success">
                                        <i class="fas fa-eye me-2"></i>View Collection
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Quick Stats -->
    <div class="row mt-5">
        <div class="col-md-4">
            <div class="card stats-card text-center">
                <div class="card-body">
                    <i class="fas fa-film fa-2x mb-3"></i>
                    <h5 id="total-movies">0</h5>
                    <p class="mb-0">Total Movies</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card stats-card text-center">
                <div class="card-body">
                    <i class="fas fa-compact-disc fa-2x mb-3"></i>
                    <h5 id="total-formats">0</h5>
                    <p class="mb-0">Different Formats</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card stats-card text-center">
                <div class="card-body">
                    <i class="fas fa-calendar fa-2x mb-3"></i>
                    <h5 id="latest-addition">-</h5>
                    <p class="mb-0">Latest Addition</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Load collection stats
    fetch('/api/movies')
        .then(response => response.json())
        .then(movies => {
            document.getElementById('total-movies').textContent = movies.length;
            
            // Count unique formats
            const formats = [...new Set(movies.map(m => m.format_type).filter(f => f))];
            document.getElementById('total-formats').textContent = formats.length;
            
            // Find latest addition
            if (movies.length > 0) {
                const latest = movies[0]; // Already sorted by date desc
                const date = new Date(latest.added_date);
                document.getElementById('latest-addition').textContent = date.toLocaleDateString();
            }
        })
        .catch(error => {
            console.error('Error loading stats:', error);
        });
});
</script>
{% endblock %}